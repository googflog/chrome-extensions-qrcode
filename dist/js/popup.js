$(function(){function a(o){$("#qr").html(""),$("#qr").qrcode(o);var t,e,n,a,i,r,s,c=o.match(/^https?:\/{2,}(.*?)(?:\/|\?|#|$)/)[1],l=(t=new Date,e=t.getFullYear().toString(),n=(t.getMonth()+1).toString(),a=t.getDate().toString(),i=t.getHours().toString(),r=t.getMinutes().toString(),s=t.getSeconds().toString(),e+n+a+i+r+s),h=$("canvas")[0].toDataURL();$(".download").attr("href",h),$(".download").attr("download","qr-"+l+"-"+c+".png")}function r(){var o=localStorage.getItem("qrcodeextensions12345");if(o){var t=JSON.parse(o);return console.log(t),t}return!1}var i,t,s="",c="";chrome.storage.sync.get({bitly_access_token:"",bitly_domain:"bit.ly"},function(o){""!=o.bitly_access_token.length?(console.log("[ Load ]",o.bitly_access_token),s=o.bitly_access_token):(console.log("[ NoLoad ]"),s="ebd7a67d641fb54e4c84e2571369de37bbb79a12"),c=o.bitly_domain}),chrome.tabs?chrome.tabs.getSelected(null,function(o){a(o.url),$("textarea").val(decodeURI(o.url)),function(o){var t=r(),e=[];console.log("historyListObj",t);var n=!1;if(t)for(var a in console.log("historyListObj",t),t)e.push(t[a]),o==t[a]&&(n=!0);n||e.push(o),30<e.length&&e.shift();var i=JSON.stringify(e);localStorage.setItem("qrcodeextensions12345",i)}($("textarea").val())}):($("#qr").qrcode(window.location.href),$("textarea").val(decodeURI(window.location.href))),$(document).on("click","#qr",function(){$(this).hasClass("expansion")?$(this).removeClass("expansion"):$(this).addClass("expansion")}),$("textarea").on("keydown",function(o){clearTimeout(t),t=setTimeout(function(){a(encodeURI($("textarea").val())),$(".copy").show()},300)}),$("textarea").on("click",function(o){$(this).addClass("click-open")}),$(".undo").on("click",function(){$("textarea").val(i),a(encodeURI($("textarea").val())),$(".bitly").show(),$(".undo").hide(),$(".url").removeClass("bit-mode"),$(".copy").hide()}),$(".copy").on("click",function(){$("textarea").focus(),$("textarea").select(),document.execCommand("copy")?console.log("コピーが成功しました！"):console.log("コピーが失敗しました!")}),$(".bitly").on("click",function(){var o,t,e,n;i=$("textarea").val(),(o=i,t=encodeURIComponent(o),e="https://api-ssl.bitly.com/v3/shorten?access_token="+s+"&longUrl="+t+"&domain="+c,n=new $.Deferred,$.ajax({type:"get",url:e,dataType:"jsonp",processData:!1,contentType:!1,success:n.resolve,error:n.reject}),n.promise()).done(function(o){o.data.url&&($(".bitly").hide(),$(".undo").show(),$(".copy").show(),$(".url").addClass("bit-mode"),$("textarea").val(o.data.url),a(o.data.url),$("textarea")[0].select())})}),$(".history").on("click",function(){!function(){$(".history-list").show(),$(".back").show(),$(".history-clear").show(),$(".history").hide(),$(".qr").hide(),$(".textarea").hide(),$(".bitly").hide(),$(".copy").hide(),$(".undo").hide(),$(".option").hide();var o=r();if(o.reverse(),o)for(var t in $(".history-list ul").html(""),o)$(".history-list ul").append('<li data-obj="'+o[t]+'">'+o[t]+"</li>")}()}),$(".back").on("click",function(){$(".history-list").hide(),$(".back").hide(),$(".history-clear").hide(),$(".history").show(),$(".qr").show(),$(".textarea").show(),$(".bitly").show(),$(".option").show(),$("textarea").val()}),$(document).on("click",".history-list li",function(){$(".history-list").hide(),$(".back").hide(),$(".history-clear").hide(),$(".history").show(),$(".qr").show(),$(".textarea").show(),$(".bitly").show(),$(".option").show();var o=$(this).data("obj");$("textarea").val(o),a(encodeURI($("textarea").val()))}),$(".history-clear").on("click",function(){localStorage.removeItem("qrcodeextensions12345"),$(".history-list ul").html("")}),$(".option").on("click",function(){chrome.runtime.openOptionsPage?chrome.runtime.openOptionsPage():window.open(chrome.runtime.getURL("options.html"))})});
//# sourceMappingURL=popup.js.map