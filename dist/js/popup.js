$(function(){function r(t){$("#qr").html(""),$("#qr").qrcode(t);var e,o,a,r,i,n,s,c=t.match(/^https?:\/{2,}(.*?)(?:\/|\?|#|$)/)[1],l=(e=new Date,o=e.getFullYear().toString(),a=(e.getMonth()+1).toString(),r=e.getDate().toString(),i=e.getHours().toString(),n=e.getMinutes().toString(),s=e.getSeconds().toString(),o+a+r+i+n+s),h=$("canvas")[0].toDataURL();$(".download").attr("href",h),$(".download").attr("download","qr-"+l+"-"+c+".png")}function n(){var t=localStorage.getItem("qrqrqrqr");if(t){var e=JSON.parse(t);return console.log(e),e}return!1}var i,e;chrome.tabs?chrome.tabs.getSelected(null,function(t){r(t.url),$("textarea").val(decodeURI(t.url)),function(t){var e=n(),o=[];console.log("historyListObj",e);var a=!1;if(e)for(var r in console.log("historyListObj",e),e)o.push(e[r]),t==e[r]&&(a=!0);a||o.push(t),30<o.length&&o.shift();var i=JSON.stringify(o);localStorage.setItem("qrqrqrqr",i)}($("textarea").val())}):($("#qr").qrcode(window.location.href),$("textarea").val(decodeURI(window.location.href))),$(document).on("click","#qr",function(){$(this).hasClass("expansion")?$(this).removeClass("expansion"):$(this).addClass("expansion")}),$("textarea").on("keydown",function(t){clearTimeout(e),e=setTimeout(function(){r(encodeURI($("textarea").val())),$(".copy").show()},300)}),$("textarea").on("click",function(t){$(this).addClass("click-open")}),$(".undo").on("click",function(){$("textarea").val(i),r(encodeURI($("textarea").val())),$(".bitly").show(),$(".undo").hide(),$(".copy").hide(),$(".url").removeClass("bit-mode")}),$(".copy").on("click",function(){$("textarea").focus(),$("textarea").select(),document.execCommand("copy")?console.log("コピーが成功しました！"):console.log("コピーが失敗しました!")}),$(".bitly").on("click",function(){i=$("textarea").val();var t,e,o,a;(t=i,e="bit.ly",o="https://api-ssl.bitly.com/v3/shorten?access_token=f21eaf9abcfe1d1edfa78193041439c80db743bc&longUrl="+encodeURIComponent(t)+"&domain="+e,a=new $.Deferred,$.ajax({type:"get",url:o,dataType:"jsonp",processData:!1,contentType:!1,success:a.resolve,error:a.reject}),a.promise()).done(function(t){$(".bitly").hide(),$(".undo").show(),$(".copy").show(),$(".url").addClass("bit-mode"),t.data.url&&($("textarea").val(t.data.url),r(t.data.url),$("textarea")[0].select())})}),$(".history").on("click",function(){!function(){$(".history-list").show(),$(".back").show(),$(".history-clear").show(),$(".history").hide(),$(".qr").hide(),$(".textarea").hide(),$(".bitly").hide(),$(".copy").hide();var t=n();if(t.reverse(),t)for(var e in $(".history-list ul").html(""),t)$(".history-list ul").append('<li data-obj="'+t[e]+'">'+t[e]+"</li>")}()}),$(".back").on("click",function(){$(".history-list").hide(),$(".back").hide(),$(".history-clear").hide(),$(".history").show(),$(".qr").show(),$(".textarea").show(),$(".bitly").show()}),$(document).on("click",".history-list li",function(){$(".history-list").hide(),$(".back").hide(),$(".history-clear").hide(),$(".history").show(),$(".qr").show(),$(".textarea").show(),$(".bitly").show(),$(".copy").show();var t=$(this).data("obj");$("textarea").val(t),r(encodeURI($("textarea").val()))}),$(".history-clear").on("click",function(){localStorage.removeItem("qrqrqrqr"),$(".history-list ul").html("")})});
//# sourceMappingURL=popup.js.map